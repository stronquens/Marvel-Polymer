<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">

<link rel="import" href="../util/rompe-cadena.html">
<link rel="import" href="./character-favorite.html">

<dom-module id="character-card">
	<template>
		<style>
			:host {
				display: flex;
			}
			
			paper-card {
				width: 250px;
				--paper-card-header-image: {
					width: 250px;
				}
				--paper-card-header-image: {
					max-height: 220px;
				}
			}
			
			h3 {
				@apply(--paper-font-headline);
				color: var(--default-primary-color);
				font-size: 1em;
				font-family: roboto, sans-serif;
			}
			
			.card-content p {
				font-size: .8em;
			}
			
			.sindescripcion {
				color: #999;
			}
			
			.card-actions {
				color: #D7CCC8;
			}
		</style>

        <paper-card image="[[character.thumbnail.path]].[[character.thumbnail.extension]]">
            <div class="card-content">
                <h3>[[character.name]]</h3>
                <p>
                    <rompe-cadena
                    str="[[character.description]]"
                    len="50"
                    ></rompe-cadena>
                    <p hidden="[[character.description]]">Without description</p>
                </p>
            </div>
            <div class="card-actions">
                <!-- <paper-icon-button icon="star"></paper-icon-button> -->
				<character-favorite
					is-fav="[[isFav]]"
					on-tap="toggleFav"
					id="[[character.id]]"
				></character-favorite>
            </div>
        </paper-card>

	</template>

	<script>
    Polymer({
      is: 'character-card',
      properties: {
          character: Object,
		  favoritos: Array,
		  isFav: {
			  type: Boolean,
			  value: false
		  }
      },
	  
      observers: [
        'definirFav(character, favoritos)'
      ],
      
      definirFav: function(character, favs) {
        if(favs.indexOf(character.id) == -1) {
          this.set('isFav',false)
        } else {
          this.set('isFav',true)
        }
      },
      toggleFav: function(e) {
        this.isFav = !this.isFav
        this.fire('toggle-fav', {
          isFav: this.isFav,
          id: this.character.id
        })
      }

    });
  </script>
</dom-module>